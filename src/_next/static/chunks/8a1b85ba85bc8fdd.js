(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";var s=e.i(43476),t=e.i(47163);function r({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card",className:(0,t.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...r})}function a({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,t.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...r})}function l({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,t.cn)("leading-none font-semibold",e),...r})}function o({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,t.cn)("text-muted-foreground text-sm",e),...r})}function i({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,t.cn)("px-6",e),...r})}e.s(["Card",()=>r,"CardContent",()=>i,"CardDescription",()=>o,"CardHeader",()=>a,"CardTitle",()=>l])},84762,e=>{"use strict";var s=e.i(43476),t=e.i(47163);function r({className:e,...r}){return(0,s.jsx)("textarea",{"data-slot":"textarea",className:(0,t.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...r})}e.s(["Textarea",()=>r])},41071,e=>{"use strict";let s=(0,e.i(75254).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>s],41071)},88699,e=>{"use strict";let s=(0,e.i(75254).default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.s(["Pencil",()=>s],88699)},43531,e=>{"use strict";var s=e.i(78745);e.s(["Check",()=>s.default])},3116,e=>{"use strict";let s=(0,e.i(75254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>s],3116)},52917,e=>{"use strict";var s=e.i(43476),t=e.i(26999),r=e.i(95926),a=e.i(47163);function l({...e}){return(0,s.jsx)(t.Root,{"data-slot":"sheet",...e})}function o({...e}){return(0,s.jsx)(t.Trigger,{"data-slot":"sheet-trigger",...e})}function i({...e}){return(0,s.jsx)(t.Portal,{"data-slot":"sheet-portal",...e})}function d({className:e,...r}){return(0,s.jsx)(t.Overlay,{"data-slot":"sheet-overlay",className:(0,a.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...r})}function n({className:e,children:l,side:o="right",...n}){return(0,s.jsxs)(i,{children:[(0,s.jsx)(d,{}),(0,s.jsxs)(t.Content,{"data-slot":"sheet-content",className:(0,a.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===o&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===o&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===o&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===o&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",e),...n,children:[l,(0,s.jsxs)(t.Close,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,s.jsx)(r.XIcon,{className:"size-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function c({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"sheet-header",className:(0,a.cn)("flex flex-col gap-1.5 p-4",e),...t})}function m({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"sheet-footer",className:(0,a.cn)("mt-auto flex flex-col gap-2 p-4",e),...t})}function x({className:e,...r}){return(0,s.jsx)(t.Title,{"data-slot":"sheet-title",className:(0,a.cn)("text-foreground font-semibold",e),...r})}function h({className:e,...r}){return(0,s.jsx)(t.Description,{"data-slot":"sheet-description",className:(0,a.cn)("text-muted-foreground text-sm",e),...r})}e.s(["Sheet",()=>l,"SheetContent",()=>n,"SheetDescription",()=>h,"SheetFooter",()=>m,"SheetHeader",()=>c,"SheetTitle",()=>x,"SheetTrigger",()=>o])},64969,e=>{"use strict";var s=e.i(43476),t=e.i(71645),r=e.i(13293),a=e.i(67881),l=e.i(23750),o=e.i(94179),i=e.i(52917),d=e.i(10708),n=e.i(84762),c=e.i(62870),m=e.i(7233),x=e.i(55436),h=e.i(41071),u=e.i(88699),p=e.i(27612),g=e.i(98919),j=e.i(3116),f=e.i(63059),b=e.i(43531),N=e.i(63415),v=e.i(70065),y=e.i(46696),C=e.i(38036),w=e.i(38447);let S={system:"bg-destructive/10 text-destructive",tenant:"bg-primary/10 text-primary",custom:"bg-warning/10 text-warning"},k={system:"系统角色",tenant:"租户角色",custom:"自定义角色"};function T(){let{t:e}=(0,w.useLanguage)(),[T,I]=(0,t.useState)(""),[D,L]=(0,t.useState)(!1),[z,B]=(0,t.useState)(!1),[P,F]=(0,t.useState)(!1),[M,O]=(0,t.useState)(null),[R,$]=(0,t.useState)(null),[A,H]=(0,t.useState)([]),[W,U]=(0,t.useState)([]),[E,J]=(0,t.useState)(!0),[K,V]=(0,t.useState)(1),[_]=(0,t.useState)(10),[X,q]=(0,t.useState)(0),[G,Q]=(0,t.useState)(!1),[Y,Z]=(0,t.useState)({roleName:"",roleCode:"",description:"",tenantCode:"",roleStatus:"1"}),[ee,es]=(0,t.useState)(""),[et,er]=(0,t.useState)(new Set(["1","2"])),ea=async(e=K)=>{J(!0);try{let s=await (0,C.fetchWithAuth)(`/admin/roles?current=${e}&size=${_}`),t=await s.json();if(200===t.code&&t.data){let s=t.data;U(s.records||[]),q(Math.ceil(s.total/_)),V(e)}}catch(e){console.error("获取角色列表失败",e)}finally{J(!1)}};(0,t.useEffect)(()=>{let e=setTimeout(()=>{T.trim()?el(T):ea(1)},500);return()=>clearTimeout(e)},[T]);let el=async e=>{J(!0);try{let s=await (0,C.fetchWithAuth)(`/admin/roles/search?roleName=${encodeURIComponent(e)}&current=1&size=${_}`),t=await s.json();if(200===t.code&&t.data){let e=t.data;U(e.records||[]),q(Math.ceil(e.total/_)),V(1)}}catch(e){console.error("搜索角色失败",e)}finally{J(!1)}},eo=async e=>{console.log("获取角色权限，角色ID:",e);try{let s=await (0,C.fetchWithAuth)(`/admin/permissions/by-role/${e}`),t=await s.json();if(console.log("角色权限响应:",t),200===t.code&&t.data){let e=t.data.assignedPermissions||[],s=t.data.unassignedPermissions||[],r=[...e.map(e=>({permissionId:e.permId,permissionCode:e.permCode,permName:e.permName,permissionType:e.permType.toString(),selected:!0})),...s.map(e=>({permissionId:e.permId,permissionCode:e.permCode,permName:e.permName,permissionType:e.permType.toString(),selected:!1}))];console.log("所有权限列表 (已分配的会标记为selected):",r),H(r)}}catch(e){console.error("获取权限列表失败",e)}},ei=(0,t.useMemo)(()=>A.filter(e=>""===ee||e.permName.toLowerCase().includes(ee.toLowerCase())||e.permissionCode.toLowerCase().includes(ee.toLowerCase())),[A,ee]),ed=(0,t.useMemo)(()=>{let e={};return ei.forEach(s=>{let t=s.permissionType||"other";e[t]||(e[t]=[]),e[t].push(s)}),e},[ei]),en=async()=>{if(R){Q(!0);try{let e=await (0,C.fetchWithAuth)("/admin/role/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({roleId:R.role.roleId,roleName:R.role.roleName,roleCode:R.role.roleCode,description:R.role.description||"",tenantId:R.role.tenantId,permissionIds:A.filter(e=>e.selected).map(e=>e.permissionId)})}),s=await e.json();200===s.code?(B(!1),ea(K),y.toast.success("更新角色成功")):y.toast.error(s.message||"更新失败")}catch(e){console.error("更新角色失败",e),y.toast.error("更新失败，请重试")}finally{Q(!1)}}},ec=async e=>{if(confirm("确定要删除该角色吗？此操作不可恢复。"))try{let s=await (0,C.fetchWithAuth)(`/admin/role/${e}/delete`,{method:"POST"}),t=await s.json();200===t.code?(ea(K),y.toast.success("删除成功")):y.toast.error(t.message||"删除失败")}catch(e){console.error("删除角色失败",e),y.toast.error("删除失败，请重试")}},em=async()=>{if(console.log("创建角色数据:",Y),!Y.tenantCode)return void y.toast.error("请输入租户代码");try{let e=await (0,C.fetchWithAuth)(`/admin/tenant/code/${Y.tenantCode}`),s=await e.json();if(console.log("租户查询响应:",s),200!==s.code)return void y.toast.error(s.message||"查询租户失败");let t=s.data.tenantId,r=await (0,C.fetchWithAuth)("/admin/role/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roleName:Y.roleName,roleCode:Y.roleCode,description:Y.description,tenantId:t,roleStatus:Y.roleStatus})});console.log("响应状态:",r.status);let a=await r.json();console.log("响应数据:",a),200===a.code?(L(!1),Z({roleName:"",roleCode:"",description:"",tenantCode:"",roleStatus:"1"}),ea(K),y.toast.success("创建角色成功")):y.toast.error(a.message||"创建失败")}catch(e){console.error("创建角色失败",e),y.toast.error("创建失败，请重试")}},ex=e=>{ea(e)},eh=W.map(e=>({id:e.role.roleId,name:e.role.roleName,code:e.role.roleCode,description:e.role.description||"",type:0===e.role.tenantId?"system":"custom",userCount:0,permissionCount:e.permissionCount,tenantName:e.tenantName,createdAt:e.role.createTime,originalData:e}));return(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsx)(r.Header,{title:e.dashboard.roles,description:e.dashboard.rolesDescription}),(0,s.jsxs)("div",{className:"flex-1 p-6 space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"relative w-80",children:[(0,s.jsx)(x.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,s.jsx)(l.Input,{placeholder:e.dashboard.rolesSearchPlaceholder,value:T,onChange:e=>I(e.target.value),className:"pl-9 bg-card border-border"})]}),(0,s.jsxs)(i.Sheet,{open:D,onOpenChange:L,children:[(0,s.jsx)(i.SheetTrigger,{asChild:!0,children:(0,s.jsxs)(a.Button,{children:[(0,s.jsx)(m.Plus,{className:"w-4 h-4 mr-2"}),e.dashboard.createRole]})}),(0,s.jsxs)(i.SheetContent,{className:"sm:max-w-[500px] flex flex-col p-0 gap-0",children:[(0,s.jsxs)(i.SheetHeader,{className:"px-6 py-4 border-b",children:[(0,s.jsx)(i.SheetTitle,{children:"新建角色"}),(0,s.jsx)(i.SheetDescription,{children:"创建一个新角色并配置其权限"})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,s.jsxs)("div",{className:"space-y-6 p-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(d.Label,{htmlFor:"tenantCode",children:["所属租户 ",(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,s.jsx)(l.Input,{id:"tenantCode",placeholder:"输入租户代码",value:Y.tenantCode,onChange:e=>Z({...Y,tenantCode:e.target.value}),className:"bg-card border-border"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(d.Label,{htmlFor:"roleName",children:["角色名称 ",(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,s.jsx)(l.Input,{id:"roleName",placeholder:"输入角色名称",value:Y.roleName,onChange:e=>Z({...Y,roleName:e.target.value}),className:"bg-card border-border"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.Label,{htmlFor:"roleCode",children:"角色代码"}),(0,s.jsx)(l.Input,{id:"roleCode",placeholder:"输入唯一标识代码",value:Y.roleCode,onChange:e=>Z({...Y,roleCode:e.target.value}),className:"bg-card border-border"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.Label,{htmlFor:"roleStatus",children:"角色状态"}),(0,s.jsxs)(c.Select,{value:Y.roleStatus,onValueChange:e=>Z({...Y,roleStatus:e}),children:[(0,s.jsx)(c.SelectTrigger,{children:(0,s.jsx)(c.SelectValue,{placeholder:"选择状态"})}),(0,s.jsxs)(c.SelectContent,{children:[(0,s.jsx)(c.SelectItem,{value:"1",children:"启用"}),(0,s.jsx)(c.SelectItem,{value:"0",children:"停用"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.Label,{htmlFor:"roleDesc",children:"角色描述"}),(0,s.jsx)(n.Textarea,{id:"roleDesc",placeholder:"描述角色的职责和权限范围",value:Y.description,onChange:e=>Z({...Y,description:e.target.value}),className:"bg-card border-border min-h-[100px]"})]})]})}),(0,s.jsxs)(i.SheetFooter,{className:"px-6 py-4 border-t bg-muted/20 sm:justify-between",children:[(0,s.jsx)(a.Button,{variant:"outline",onClick:()=>L(!1),children:"取消"}),(0,s.jsx)(a.Button,{onClick:em,children:"创建角色"})]})]})]})]}),E?(0,s.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):0===W.length?(0,s.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:"暂无角色数据"}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:eh.map(e=>(0,s.jsxs)(v.Card,{className:"bg-card border-border hover:shadow-lg transition-all duration-300",children:[(0,s.jsx)(v.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(v.CardTitle,{className:"text-base",children:e.name}),(0,s.jsx)(v.CardDescription,{className:"text-xs mt-1",children:e.code})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.Badge,{className:S[e.type],children:k[e.type]}),(0,s.jsxs)(N.DropdownMenu,{children:[(0,s.jsx)(N.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(a.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,s.jsx)(h.MoreHorizontal,{className:"w-4 h-4"})})}),(0,s.jsxs)(N.DropdownMenuContent,{align:"end",children:[(0,s.jsxs)(N.DropdownMenuItem,{onClick:()=>{O(e.originalData),F(!0)},children:[(0,s.jsx)(g.Shield,{className:"w-4 h-4 mr-2"}),"查看详情"]}),(0,s.jsxs)(N.DropdownMenuItem,{onClick:()=>{$(e.originalData),B(!0),eo(e.id)},children:[(0,s.jsx)(u.Pencil,{className:"w-4 h-4 mr-2"}),"编辑"]}),(0,s.jsxs)(N.DropdownMenuItem,{className:"text-destructive",disabled:"system"===e.type,onClick:()=>ec(e.id),children:[(0,s.jsx)(p.Trash2,{className:"w-4 h-4 mr-2"}),"删除角色"]})]})]})]})]})}),(0,s.jsxs)(v.CardContent,{className:"space-y-3",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[e.tenantName&&(0,s.jsx)("span",{className:"text-muted-foreground",children:e.tenantName}),(0,s.jsxs)("span",{className:"text-muted-foreground",children:[e.permissionCount," 权限项"]})]})]})]},e.id))}),X>1&&(0,s.jsxs)("div",{className:"flex justify-center items-center gap-2 pt-4",children:[(0,s.jsx)(a.Button,{variant:"outline",size:"sm",onClick:()=>ex(K-1),disabled:1===K,children:"上一页"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:["第 ",K," / ",X," 页"]}),(0,s.jsx)(a.Button,{variant:"outline",size:"sm",onClick:()=>ex(K+1),disabled:K===X,children:"下一页"})]})]}),(0,s.jsx)(i.Sheet,{open:P,onOpenChange:F,children:(0,s.jsxs)(i.SheetContent,{className:"sm:max-w-[500px] flex flex-col p-0 gap-0",children:[(0,s.jsxs)(i.SheetHeader,{className:"px-6 py-4 border-b",children:[(0,s.jsx)(i.SheetTitle,{children:"角色详情"}),(0,s.jsx)(i.SheetDescription,{children:"查看角色的详细信息"})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:M&&(0,s.jsxs)("div",{className:"space-y-6 p-6",children:[(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-primary/10 rounded-2xl flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(g.Shield,{className:"w-8 h-8 text-primary"})}),(0,s.jsxs)("div",{className:"flex-1 pt-1",children:[(0,s.jsx)("h4",{className:"text-xl font-semibold text-foreground",children:M.role.roleName}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground mt-1 flex items-center gap-2",children:[M.role.roleCode,(0,s.jsx)(o.Badge,{className:1===M.role.roleStatus?"bg-success/10 text-success":"bg-muted text-muted-foreground",children:1===M.role.roleStatus?"启用":"禁用"})]})]})]}),(0,s.jsxs)("div",{className:"grid gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-muted-foreground mb-4",children:"基础信息"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 bg-muted/20 p-4 rounded-lg",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(d.Label,{className:"text-xs text-muted-foreground",children:"租户 ID"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:M.role.tenantId})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(d.Label,{className:"text-xs text-muted-foreground",children:"权限数量"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:M.permissionCount})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-muted-foreground mb-4",children:"时间信息"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)(d.Label,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(j.Clock,{className:"w-3 h-3"})," 创建时间"]}),(0,s.jsx)("div",{className:"text-sm",children:M.role.createTime?new Date(M.role.createTime).toLocaleString("zh-CN"):"-"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)(d.Label,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(j.Clock,{className:"w-3 h-3"})," 更新时间"]}),(0,s.jsx)("div",{className:"text-sm",children:M.role.updateTime?new Date(M.role.updateTime).toLocaleString("zh-CN"):"-"})]})]})]}),M.role.description&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-muted-foreground mb-4",children:"描述"}),(0,s.jsx)("p",{className:"text-sm text-foreground bg-muted/50 p-4 rounded-lg border border-border/50",children:M.role.description})]})]})]})}),(0,s.jsx)(i.SheetFooter,{className:"px-6 py-4 border-t mt-auto",children:(0,s.jsx)(a.Button,{onClick:()=>F(!1),className:"w-full sm:w-auto",children:"关闭"})})]})}),(0,s.jsx)(i.Sheet,{open:z,onOpenChange:B,children:(0,s.jsxs)(i.SheetContent,{className:"w-[90vw] sm:w-[600px] sm:max-w-[600px] flex flex-col p-0 gap-0",children:[(0,s.jsxs)(i.SheetHeader,{className:"px-6 py-4 border-b border-border shrink-0",children:[(0,s.jsxs)(i.SheetTitle,{className:"flex items-center gap-2 text-xl",children:[(0,s.jsx)(u.Pencil,{className:"w-5 h-5"}),"编辑角色"]}),(0,s.jsx)(i.SheetDescription,{children:"修改角色信息和权限配置"})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:R&&(0,s.jsxs)("div",{className:"flex flex-col min-h-full",children:[(0,s.jsxs)("div",{className:"px-6 py-6 border-b border-border bg-muted/30",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-muted-foreground mb-4",children:"基本信息"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.Label,{htmlFor:"editRoleName",className:"text-sm font-medium",children:"角色名称"}),(0,s.jsx)(l.Input,{id:"editRoleName",value:R.role.roleName,onChange:e=>$({...R,role:{...R.role,roleName:e.target.value}}),className:"bg-card border-border h-9"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.Label,{htmlFor:"editRoleCode",className:"text-sm font-medium",children:"角色代码"}),(0,s.jsx)(l.Input,{id:"editRoleCode",value:R.role.roleCode,onChange:e=>$({...R,role:{...R.role,roleCode:e.target.value}}),className:"bg-card border-border h-9"})]})]}),(0,s.jsxs)("div",{className:"space-y-2 mt-4",children:[(0,s.jsx)(d.Label,{htmlFor:"editRoleDesc",className:"text-sm font-medium",children:"角色描述"}),(0,s.jsx)(n.Textarea,{id:"editRoleDesc",value:R.role.description||"",onChange:e=>$({...R,role:{...R.role,description:e.target.value}}),placeholder:"描述角色的职责和权限范围",className:"bg-card border-border resize-none h-20"})]})]}),(0,s.jsxs)("div",{className:"flex-1 p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4 shrink-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"p-1.5 bg-primary/10 rounded-md",children:(0,s.jsx)(g.Shield,{className:"w-4 h-4 text-primary"})}),(0,s.jsx)("h4",{className:"text-sm font-medium",children:"权限配置"})]}),(0,s.jsx)("div",{className:"flex items-center gap-3",children:(0,s.jsxs)(o.Badge,{variant:"outline",className:"font-normal",children:["已选 ",A.filter(e=>e.selected).length," / ",A.length]})})]}),(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(x.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,s.jsx)(l.Input,{placeholder:"搜索权限名称或代码...",value:ee,onChange:e=>es(e.target.value),className:"pl-9 h-9 bg-card border-border"})]})}),(0,s.jsxs)("div",{className:"space-y-6",children:[Object.entries(ed).map(([e,t])=>{let r=t.length>0&&t.every(e=>e.selected),a=t.some(e=>e.selected)&&!r;return(0,s.jsxs)("div",{className:"bg-card rounded-xl border shadow-sm overflow-hidden",children:[(0,s.jsx)("div",{className:"flex items-center justify-between px-4 py-3 bg-muted/50 border-b border-border",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{type:"checkbox",ref:e=>{e&&(e.indeterminate=a)},checked:r,onChange:s=>{var t;t=s.target.checked,H(A.map(s=>s.permissionType===e?{...s,selected:t}:s)),et.has(e)||er(s=>new Set(s).add(e))},className:"rounded border-gray-300 w-4 h-4 cursor-pointer accent-primary"}),(0,s.jsx)(d.Label,{className:"font-medium cursor-pointer flex items-center gap-2 select-none",children:(0,s.jsxs)("button",{onClick:()=>{er(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},className:"flex items-center gap-2 hover:bg-muted/50 rounded px-1 py-0.5 transition-colors",children:[(0,s.jsx)("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium border ${"1"===e?"bg-blue-50 text-blue-700 border-blue-200":"2"===e?"bg-green-50 text-green-700 border-green-200":"3"===e?"bg-purple-50 text-purple-700 border-purple-200":"bg-gray-50 text-gray-700 border-gray-200"}`,children:"1"===e?"菜单权限":"2"===e?"按钮权限":"3"===e?"接口权限":"其他权限"}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",t.filter(e=>e.selected).length,"/",t.length,")"]}),(0,s.jsx)(f.ChevronRight,{className:`w-3.5 h-3.5 text-muted-foreground transition-transform duration-200 ${et.has(e)?"rotate-90":""}`})]})})]})}),et.has(e)&&(0,s.jsx)("div",{className:"p-3 bg-card",children:(0,s.jsx)("div",{className:"grid grid-cols-1 gap-2",children:t.map(e=>(0,s.jsxs)("div",{className:`flex items-center gap-3 p-2 rounded-md border transition-all cursor-pointer ${e.selected?"bg-primary/5 border-primary/20 shadow-sm":"bg-background border-border hover:bg-muted/50"}`,onClick:()=>{H(A.map(s=>s.permissionCode===e.permissionCode?{...s,selected:!s.selected}:s))},children:[(0,s.jsx)("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${e.selected?"bg-primary border-primary text-primary-foreground":"border-input bg-background"}`,children:e.selected&&(0,s.jsx)(b.Check,{className:"w-3 h-3"})}),(0,s.jsx)("div",{className:"flex-1 min-w-0",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-0.5",children:[(0,s.jsx)("span",{className:"text-sm font-medium truncate",children:e.permName}),(0,s.jsx)(o.Badge,{variant:"secondary",className:"text-[10px] h-5 px-1.5 font-mono font-normal opacity-70",children:e.permissionCode})]})})]},e.permissionCode))})})]},e)}),0===Object.keys(ed).length&&(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:[(0,s.jsx)(g.Shield,{className:"w-12 h-12 mb-3 opacity-50"}),(0,s.jsx)("p",{className:"text-sm",children:ee?"没有找到匹配的权限":"暂无权限数据"})]})]})]})]})}),(0,s.jsxs)(i.SheetFooter,{className:"px-6 py-4 border-t border-border bg-muted/30 shrink-0 sm:justify-between",children:[(0,s.jsx)(a.Button,{variant:"outline",onClick:()=>{B(!1),es("")},disabled:G,children:"取消"}),(0,s.jsx)(a.Button,{onClick:en,disabled:G,className:"min-w-[100px]",children:G?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"保存中..."]}):"保存更改"})]})]})})]})}e.s(["default",()=>T])}]);