(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,16715,e=>{"use strict";let t=(0,e.i(75254).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},78928,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(13293),r=e.i(47163);function i({title:e,value:s,change:a,changeType:i="neutral",icon:d}){return(0,t.jsx)("div",{className:"bg-card border border-border rounded-xl p-5",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-foreground mt-1",children:s}),a&&(0,t.jsx)("p",{className:(0,r.cn)("text-xs mt-2","increase"===i&&"text-success","decrease"===i&&"text-destructive","neutral"===i&&"text-muted-foreground"),children:a})]}),(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,t.jsx)(d,{className:"w-5 h-5 text-primary"})})]})})}var d=e.i(61911),c=e.i(98919),n=e.i(34161),o=e.i(16715),l=e.i(7486),u=e.i(38036),h=e.i(38447);function x(){let{t:e,language:r}=(0,h.useLanguage)(),[x,m]=(0,s.useState)(0),[f,j]=(0,s.useState)(0),[g,b]=(0,s.useState)(0),[p,v]=(0,s.useState)(0),[y,N]=(0,s.useState)([]),[w,S]=(0,s.useState)(!0),[A,T]=(0,s.useState)(!1),$=async()=>{T(!0);try{let e=await (0,u.fetchWithAuth)("/sys/log/recent"),t=await e.json();200===t.code&&N(t.data||[])}catch(e){console.error("刷新最近活动失败",e)}finally{T(!1)}};return(0,s.useEffect)(()=>{(async()=>{try{let e=(0,u.isAdminTenant)(),t=[(0,u.fetchWithAuth)("/sys/log/recent")];e&&t.push((0,u.fetchWithAuth)("/admin/tenant/count"),(0,u.fetchWithAuth)("/admin/users/count"),(0,u.fetchWithAuth)("/admin/roles/count"),(0,u.fetchWithAuth)("/admin/permissions/count"));let s=await Promise.all(t),a=await s[0].json();if(200===a.code&&N(a.data||[]),e){let e=await s[1].json(),t=await s[2].json(),a=await s[3].json(),r=await s[4].json();200===e.code&&m(e.data||0),200===t.code&&j(t.data||0),200===a.code&&b(a.data||0),200===r.code&&v(r.data||0)}}catch(e){console.error("获取统计数据失败",e)}finally{S(!1)}})()},[]),(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsx)(a.Header,{title:e.dashboard.title,description:e.dashboard.description}),(0,t.jsxs)("div",{className:"flex-1 p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsx)(i,{title:e.dashboard.tenants,value:w?"...":x.toLocaleString(),icon:l.Building2}),(0,t.jsx)(i,{title:e.dashboard.users,value:w?"...":f.toLocaleString(),icon:d.Users}),(0,t.jsx)(i,{title:e.dashboard.roles,value:w?"...":g.toLocaleString(),icon:c.Shield}),(0,t.jsx)(i,{title:e.dashboard.permissions,value:w?"...":p.toLocaleString(),icon:n.Key})]}),(0,t.jsxs)("div",{className:"bg-card border border-border rounded-xl p-5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-foreground",children:e.dashboard.recentActivity}),(0,t.jsxs)("button",{onClick:$,disabled:A,className:"flex items-center gap-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)(o.RefreshCw,{className:`w-3.5 h-3.5 ${A?"animate-spin":""}`}),(0,t.jsx)("span",{children:e.dashboard.refresh})]})]}),(0,t.jsx)("div",{className:"space-y-3",children:0===y.length?(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.dashboard.noRecentActivity}):y.map((e,s)=>{var a;let i,d,c,n,o,l;return(0,t.jsxs)("div",{className:"py-2 border-b border-border last:border-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-foreground",children:e.username}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:(a=e.createTime,i=new Date,d=new Date(a),n=Math.floor((c=i.getTime()-d.getTime())/6e4),o=Math.floor(c/36e5),l=Math.floor(c/864e5),"en"===r?l>0?`${l} days ago`:o>0?`${o} hours ago`:n>0?`${n} mins ago`:"Just now":l>0?`${l} 天前`:o>0?`${o} 小时前`:n>0?`${n} 分钟前`:"刚刚")})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,t.jsx)("span",{className:"text-muted-foreground truncate flex-1",children:e.url}),(0,t.jsx)("span",{className:`px-2 py-0.5 rounded ${200===e.status?"bg-success/10 text-success":"bg-destructive/10 text-destructive"}`,children:e.status})]})]},s)})})]})]})]})}e.s(["default",()=>x],78928)}]);