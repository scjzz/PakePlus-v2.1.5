(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3116,e=>{"use strict";let s=(0,e.i(75254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>s],3116)},41071,e=>{"use strict";let s=(0,e.i(75254).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>s],41071)},88699,e=>{"use strict";let s=(0,e.i(75254).default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.s(["Pencil",()=>s],88699)},86536,e=>{"use strict";let s=(0,e.i(75254).default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],86536)},47627,e=>{"use strict";var s=e.i(43476),a=e.i(47163);function r({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",e),...r})})}function t({className:e,...r}){return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",e),...r})}function l({className:e,...r}){return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",e),...r})}function n({className:e,...r}){return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...r})}function i({className:e,...r}){return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}function d({className:e,...r}){return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}e.s(["Table",()=>r,"TableBody",()=>l,"TableCell",()=>d,"TableHead",()=>i,"TableHeader",()=>t,"TableRow",()=>n])},8623,e=>{"use strict";var s=e.i(43476),a=e.i(71645),r=e.i(47627),t=e.i(67881),l=e.i(23750),n=e.i(73375),i=e.i(63059);function d({data:e,columns:d,page:o=1,totalPages:c=1,onPageChange:m,loading:u=!1}){let[h,x]=a.useState(o.toString());return a.useEffect(()=>{x(o.toString())},[o]),(0,s.jsxs)("div",{className:"bg-card border border-border rounded-xl overflow-hidden",children:[(0,s.jsxs)(r.Table,{children:[(0,s.jsx)(r.TableHeader,{children:(0,s.jsx)(r.TableRow,{className:"border-border hover:bg-transparent",children:d.map(e=>(0,s.jsx)(r.TableHead,{className:"text-muted-foreground font-medium",children:e.header},String(e.key)))})}),(0,s.jsx)(r.TableBody,{children:u?(0,s.jsx)(r.TableRow,{children:(0,s.jsx)(r.TableCell,{colSpan:d.length,className:"text-center py-8",children:(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-primary border-t-transparent"})})})}):0===e.length?(0,s.jsx)(r.TableRow,{children:(0,s.jsx)(r.TableCell,{colSpan:d.length,className:"text-center py-8 text-muted-foreground",children:"暂无数据"})}):e.map(e=>(0,s.jsx)(r.TableRow,{className:"border-border hover:bg-muted/50",children:d.map(a=>(0,s.jsx)(r.TableCell,{children:a.render?a.render(e):String(e[a.key]??"")},String(a.key)))},e.id))})]}),c>1&&(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-t border-border",children:[(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["共 ",c," 页"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(t.Button,{variant:"outline",size:"sm",onClick:()=>m?.(o-1),disabled:o<=1,children:(0,s.jsx)(n.ChevronLeft,{className:"w-4 h-4"})}),(0,s.jsx)(l.Input,{type:"number",min:1,max:c,value:h,onChange:e=>{let s=e.target.value;x(s);let a=parseInt(s);a>=1&&a<=c&&m?.(a)},onBlur:()=>{let e=parseInt(h);isNaN(e)||e<1?e=1:e>c&&(e=c),x(e.toString()),m?.(e)},className:"w-16 h-8 text-center"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:["/ ",c]}),(0,s.jsx)(t.Button,{variant:"outline",size:"sm",onClick:()=>m?.(o+1),disabled:o>=c,children:(0,s.jsx)(i.ChevronRight,{className:"w-4 h-4"})})]})]})]})}e.s(["DataTable",()=>d])},17058,e=>{"use strict";var s=e.i(43476),a=e.i(71645),r=e.i(38447),t=e.i(13293),l=e.i(8623),n=e.i(67881),i=e.i(23750),d=e.i(94179),o=e.i(30374),c=e.i(10708),m=e.i(62870),u=e.i(7233),h=e.i(55436),x=e.i(41071),g=e.i(88699),p=e.i(27612),j=e.i(86536),f=e.i(84614),b=e.i(61911),N=e.i(98919),v=e.i(3116),y=e.i(75254);let w=(0,y.default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),k=(0,y.default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);var C=e.i(63415),S=e.i(30030),I=e.i(30207),T=e.i(34620),D=e.i(48425),L="Avatar",[A,P]=(0,S.createContextScope)(L),[B,z]=A(L),F=a.forwardRef((e,r)=>{let{__scopeAvatar:t,...l}=e,[n,i]=a.useState("idle");return(0,s.jsx)(B,{scope:t,imageLoadingStatus:n,onImageLoadingStatusChange:i,children:(0,s.jsx)(D.Primitive.span,{...l,ref:r})})});F.displayName=L;var R="AvatarImage";a.forwardRef((e,r)=>{let{__scopeAvatar:t,src:l,onLoadingStatusChange:n=()=>{},...i}=e,d=z(R,t),o=function(e,s){let[r,t]=a.useState("idle");return(0,T.useLayoutEffect)(()=>{if(!e)return void t("error");let a=!0,r=new window.Image,l=e=>()=>{a&&t(e)};return t("loading"),r.onload=l("loaded"),r.onerror=l("error"),r.src=e,s&&(r.referrerPolicy=s),()=>{a=!1}},[e,s]),r}(l,i.referrerPolicy),c=(0,I.useCallbackRef)(e=>{n(e),d.onImageLoadingStatusChange(e)});return(0,T.useLayoutEffect)(()=>{"idle"!==o&&c(o)},[o,c]),"loaded"===o?(0,s.jsx)(D.Primitive.img,{...i,ref:r,src:l}):null}).displayName=R;var M="AvatarFallback",E=a.forwardRef((e,r)=>{let{__scopeAvatar:t,delayMs:l,...n}=e,i=z(M,t),[d,o]=a.useState(void 0===l);return a.useEffect(()=>{if(void 0!==l){let e=window.setTimeout(()=>o(!0),l);return()=>window.clearTimeout(e)}},[l]),d&&"loaded"!==i.imageLoadingStatus?(0,s.jsx)(D.Primitive.span,{...n,ref:r}):null});E.displayName=M;var H=e.i(47163);function O({className:e,...a}){return(0,s.jsx)(F,{"data-slot":"avatar",className:(0,H.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",e),...a})}function U({className:e,...a}){return(0,s.jsx)(E,{"data-slot":"avatar-fallback",className:(0,H.cn)("bg-muted flex size-full items-center justify-center rounded-full",e),...a})}var W=e.i(46696),$=e.i(38036);let J={active:"bg-success/10 text-success",inactive:"bg-muted text-muted-foreground",locked:"bg-destructive/10 text-destructive"},K={active:"正常",inactive:"未激活",locked:"已锁定"};function V(){let{t:e}=(0,r.useLanguage)(),[y,S]=(0,a.useState)(""),[I,T]=(0,a.useState)(!1),[D,L]=(0,a.useState)(!1),[A,P]=(0,a.useState)(!1),[B,z]=(0,a.useState)(null),[F,R]=(0,a.useState)(null),[M,E]=(0,a.useState)([]),[H,V]=(0,a.useState)([]),[_,q]=(0,a.useState)([]),[G,Q]=(0,a.useState)(!0),[X,Y]=(0,a.useState)(1),[Z]=(0,a.useState)(10),[ee,es]=(0,a.useState)(0),[ea,er]=(0,a.useState)(!1),[et,el]=(0,a.useState)(!1),[en,ei]=(0,a.useState)({username:"",nickname:"",email:"",phone:"",password:"",tenantCode:"",userStatus:"1"}),ed=async(e=X)=>{Q(!0);try{let s=await (0,$.fetchWithAuth)(`/admin/users?current=${e}&size=${Z}`),a=await s.json();if(200===a.code&&a.data){let s=a.data;q(s.records||[]),es(Math.ceil(s.total/Z)),Y(e)}}catch(e){console.error("获取用户列表失败",e)}finally{Q(!1)}},eo=async()=>{try{let e=await (0,$.fetchWithAuth)("/admin/tenants/list"),s=await e.json();200===s.code&&s.data&&V(s.data||[])}catch(e){console.error("获取租户列表失败",e)}};(0,a.useEffect)(()=>{em(),eo()},[]),(0,a.useEffect)(()=>{let e=setTimeout(()=>{y.trim()?ec(y):ed(1)},500);return()=>clearTimeout(e)},[y]);let ec=async e=>{Q(!0);try{let s=await (0,$.fetchWithAuth)(`/admin/users/search/paginated?username=${encodeURIComponent(e)}&current=1&size=${Z}`),a=await s.json();if(200===a.code&&a.data){let e=a.data;q(e.records||[]),es(Math.ceil(e.total/Z)),Y(1)}}catch(e){console.error("搜索用户失败",e)}finally{Q(!1)}},em=async()=>{try{let e=await (0,$.fetchWithAuth)("/admin/roles/list"),s=await e.json();200===s.code&&s.data&&E(s.data||[])}catch(e){console.error("获取角色列表失败",e)}},eu=async e=>{R(e.originalData),L(!0);try{let s=await (0,$.fetchWithAuth)(`/admin/users/by-role/${e.id}`),a=await s.json();if(console.log("用户角色响应:",a),200===a.code&&a.data){let s=a.data.assignedRoles||[],r=a.data.unassignedRoles||[],t=[...s.map(e=>({roleId:e.roleId,roleName:e.roleName,roleCode:e.roleCode})),...r.map(e=>({roleId:e.roleId,roleName:e.roleName,roleCode:e.roleCode}))];E(t),R({...e.originalData,roles:s.map(e=>({roleId:e.roleId,roleName:e.roleName,roleCode:e.roleCode}))})}}catch(e){console.error("获取用户角色失败",e)}},eh=async()=>{if(F){er(!0);try{let e=await (0,$.fetchWithAuth)("/admin/user/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:F.user.userId,nickname:F.user.nickname,email:F.user.email,phone:F.user.phone,roleIds:F.roles.map(e=>e.roleId)})}),s=await e.json();200===s.code?(L(!1),ed(X),W.toast.success("更新用户成功")):W.toast.error(s.message||"更新失败")}catch(e){console.error("更新用户失败",e),W.toast.error("更新失败，请重试")}finally{er(!1)}}},ex=async()=>{if(console.log("创建用户数据:",en),!en.tenantCode)return void W.toast.error("请选择租户");el(!0);try{let e=await (0,$.fetchWithAuth)(`/admin/tenant/code/${en.tenantCode}`),s=await e.json();if(console.log("租户查询响应:",s),200!==s.code)return void W.toast.error(s.message||"查询租户失败");let a=s.data.tenantId,r=await (0,$.fetchWithAuth)("/admin/user/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:en.username,nickname:en.nickname,email:en.email,phone:en.phone,password:en.password,tenantId:a,userStatus:en.userStatus})});console.log("响应状态:",r.status);let t=await r.json();console.log("响应数据:",t),200===t.code?(T(!1),ei({username:"",nickname:"",email:"",phone:"",password:"",tenantCode:"",userStatus:"1"}),ed(X),W.toast.success("创建用户成功")):W.toast.error(t.message||"创建失败")}catch(e){console.error("创建用户失败",e),W.toast.error("创建失败，请重试")}finally{el(!1)}},eg=async e=>{if(confirm(`确定要删除用户"${e.name}"吗？此操作不可恢复！`))try{console.log("删除用户ID:",e.id);let s=await (0,$.fetchWithAuth)(`/admin/user/${e.id}/delete`,{method:"POST"});console.log("响应状态:",s.status);let a=await s.json();console.log("响应数据:",a),200===a.code?(W.toast.success("删除成功"),ed(X)):W.toast.error(a.message||"删除失败")}catch(e){console.error("删除用户失败",e),W.toast.error("删除失败，请重试")}},ep=[{key:"name",header:"用户",render:e=>(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(O,{className:"w-8 h-8",children:(0,s.jsx)(U,{className:"bg-primary/10 text-primary text-xs",children:e.name.slice(0,2)})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-foreground",children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["@",e.username]})]})]})},{key:"email",header:"邮箱",render:e=>(0,s.jsx)("span",{className:"text-foreground text-sm",children:e.email})},{key:"roles",header:"角色",render:e=>(0,s.jsx)(d.Badge,{variant:"outline",children:e.roles})},{key:"status",header:"状态",render:e=>(0,s.jsx)(d.Badge,{className:J[e.status],children:K[e.status]})},{key:"createdAt",header:"创建日期",render:e=>(0,s.jsx)("span",{className:"text-muted-foreground text-sm",children:e.createdAt?new Date(e.createdAt).toLocaleDateString("zh-CN"):"-"})},{key:"actions",header:"操作",render:e=>(0,s.jsxs)(C.DropdownMenu,{children:[(0,s.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(n.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(x.MoreHorizontal,{className:"w-4 h-4"})})}),(0,s.jsxs)(C.DropdownMenuContent,{align:"end",children:[(0,s.jsxs)(C.DropdownMenuItem,{onClick:()=>{z(e.originalData),P(!0)},children:[(0,s.jsx)(j.Eye,{className:"w-4 h-4 mr-2"}),"查看详情"]}),(0,s.jsxs)(C.DropdownMenuItem,{onClick:()=>eu(e),children:[(0,s.jsx)(g.Pencil,{className:"w-4 h-4 mr-2"}),"编辑用户"]}),(0,s.jsxs)(C.DropdownMenuItem,{className:"text-destructive",onClick:()=>eg(e),children:[(0,s.jsx)(p.Trash2,{className:"w-4 h-4 mr-2"}),"删除用户"]})]})]})}],ej=_.filter(e=>e&&e.user).map(e=>({id:e.user.userId,name:e.user.nickname||e.user.username,username:e.user.username,email:e.user.email,phone:e.user.phone,tenantId:e.user.tenantId,roles:e.roles?e.roles.map(e=>e.roleName).join(", "):"",status:1===e.user.userStatus?"active":0===e.user.userStatus?"inactive":"locked",createdAt:e.user.createTime,updatedAt:e.user.updateTime,originalData:e}));return(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsx)(t.Header,{title:e.dashboard.users,description:e.dashboard.usersDescription}),(0,s.jsxs)("div",{className:"flex-1 p-6 space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"relative w-80",children:[(0,s.jsx)(h.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,s.jsx)(i.Input,{placeholder:e.dashboard.usersSearchPlaceholder,value:y,onChange:e=>S(e.target.value),className:"pl-9 bg-card border-border"})]}),(0,s.jsxs)(o.Dialog,{open:I,onOpenChange:T,children:[(0,s.jsx)(o.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(n.Button,{children:[(0,s.jsx)(u.Plus,{className:"w-4 h-4 mr-2"}),e.dashboard.createUser]})}),(0,s.jsxs)(o.DialogContent,{className:"sm:max-w-md",children:[(0,s.jsxs)(o.DialogHeader,{children:[(0,s.jsx)(o.DialogTitle,{children:"新建用户"}),(0,s.jsx)(o.DialogDescription,{children:"为租户创建一个新用户账户"})]}),(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"tenantCode",children:"所属租户"}),(0,s.jsx)(i.Input,{id:"tenantCode",placeholder:"输入租户代码",value:en.tenantCode,onChange:e=>ei({...en,tenantCode:e.target.value}),className:"bg-card border-border"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"userStatus",children:"用户状态"}),(0,s.jsxs)(m.Select,{value:en.userStatus,onValueChange:e=>ei({...en,userStatus:e}),children:[(0,s.jsx)(m.SelectTrigger,{children:(0,s.jsx)(m.SelectValue,{placeholder:"选择状态"})}),(0,s.jsxs)(m.SelectContent,{children:[(0,s.jsx)(m.SelectItem,{value:"1",children:"正常"}),(0,s.jsx)(m.SelectItem,{value:"0",children:"已锁定"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"username",children:"用户名"}),(0,s.jsx)(i.Input,{id:"username",placeholder:"输入用户名",value:en.username,onChange:e=>ei({...en,username:e.target.value}),className:"bg-card border-border"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"nickname",children:"昵称"}),(0,s.jsx)(i.Input,{id:"nickname",placeholder:"输入昵称",value:en.nickname,onChange:e=>ei({...en,nickname:e.target.value}),className:"bg-card border-border"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"email",children:"邮箱"}),(0,s.jsx)(i.Input,{id:"email",type:"email",placeholder:"user@example.com",value:en.email,onChange:e=>ei({...en,email:e.target.value}),className:"bg-card border-border"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"phone",children:"手机号"}),(0,s.jsx)(i.Input,{id:"phone",placeholder:"输入手机号",value:en.phone,onChange:e=>ei({...en,phone:e.target.value}),className:"bg-card border-border"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"password",children:"初始密码"}),(0,s.jsx)(i.Input,{id:"password",type:"password",placeholder:"设置初始密码",value:en.password,onChange:e=>ei({...en,password:e.target.value}),className:"bg-card border-border"})]})]}),(0,s.jsxs)(o.DialogFooter,{children:[(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>{T(!1)},children:"取消"}),(0,s.jsx)(n.Button,{onClick:ex,children:"创建用户"})]})]})]})]}),(0,s.jsx)(l.DataTable,{data:ej,columns:ep,page:X,totalPages:ee,onPageChange:e=>{ed(e)},loading:G})]}),(0,s.jsx)(o.Dialog,{open:A,onOpenChange:P,children:(0,s.jsxs)(o.DialogContent,{className:"sm:max-w-lg",children:[(0,s.jsxs)(o.DialogHeader,{children:[(0,s.jsx)(o.DialogTitle,{children:"用户详情"}),(0,s.jsx)(o.DialogDescription,{children:"查看用户的详细信息"})]}),B&&(0,s.jsxs)("div",{className:"space-y-6 py-4",children:[(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(f.User,{className:"w-6 h-6 text-primary"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"text-lg font-semibold text-foreground",children:B.user.nickname||B.user.username}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["@",B.user.username]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{className:"text-muted-foreground",children:"用户状态"}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(d.Badge,{className:J[1===B.user.userStatus?"active":0===B.user.userStatus?"inactive":"locked"],children:1===B.user.userStatus?K.active:0===B.user.userStatus?K.inactive:K.locked})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{className:"text-muted-foreground",children:"租户 ID"}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("span",{className:"text-foreground font-medium",children:B.user.tenantId})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{className:"text-muted-foreground",children:"邮箱"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(w,{className:"w-4 h-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-foreground",children:B.user.email||"-"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{className:"text-muted-foreground",children:"手机号"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(k,{className:"w-4 h-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-foreground",children:B.user.phone||"-"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{className:"text-muted-foreground",children:"创建时间"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Clock,{className:"w-4 h-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-foreground",children:B.user.createTime?new Date(B.user.createTime).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{className:"text-muted-foreground",children:"更新时间"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Clock,{className:"w-4 h-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-foreground",children:B.user.updateTime?new Date(B.user.updateTime).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"})]})]})]}),B.roles&&B.roles.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{className:"text-muted-foreground",children:"用户角色"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:B.roles.map(e=>(0,s.jsxs)(d.Badge,{variant:"outline",className:"flex items-center gap-1",children:[(0,s.jsx)(N.Shield,{className:"w-3 h-3"}),e.roleName]},e.roleId))})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 pt-2 border-t border-border",children:[(0,s.jsx)(f.User,{className:"w-4 h-4 text-muted-foreground"}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["用户 ID: ",B.user.userId]})]})]}),(0,s.jsx)(o.DialogFooter,{children:(0,s.jsx)(n.Button,{onClick:()=>P(!1),children:"关闭"})})]})}),(0,s.jsx)(o.Dialog,{open:D,onOpenChange:L,children:(0,s.jsxs)(o.DialogContent,{className:"w-[95vw] max-w-2xl max-h-[90vh] overflow-hidden flex flex-col p-0",children:[(0,s.jsxs)(o.DialogHeader,{className:"px-6 pt-6 pb-4 border-b border-border shrink-0",children:[(0,s.jsxs)(o.DialogTitle,{className:"flex items-center gap-2 text-xl",children:[(0,s.jsx)(f.User,{className:"w-5 h-5"}),"编辑用户"]}),(0,s.jsx)(o.DialogDescription,{children:"修改用户信息和分配角色"})]}),F&&(0,s.jsxs)("div",{className:"flex-1 overflow-hidden flex flex-col",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-border bg-muted/30 shrink-0",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"editNickname",className:"text-sm font-medium",children:"昵称"}),(0,s.jsx)(i.Input,{id:"editNickname",value:F.user.nickname||"",onChange:e=>R({...F,user:{...F.user,nickname:e.target.value}}),className:"bg-card border-border h-10"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"editEmail",className:"text-sm font-medium",children:"邮箱"}),(0,s.jsx)(i.Input,{id:"editEmail",type:"email",value:F.user.email||"",onChange:e=>R({...F,user:{...F.user,email:e.target.value}}),className:"bg-card border-border h-10"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"editPhone",className:"text-sm font-medium",children:"手机号"}),(0,s.jsx)(i.Input,{id:"editPhone",value:F.user.phone||"",onChange:e=>R({...F,user:{...F.user,phone:e.target.value}}),className:"bg-card border-border h-10"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{className:"text-sm font-medium",children:"用户状态"}),(0,s.jsx)("div",{className:"flex items-center h-10 px-3 bg-muted/50 rounded-md",children:(0,s.jsx)(d.Badge,{className:1===F.user.userStatus?"bg-green-100 text-green-700 border-green-300":"bg-red-100 text-red-700 border-red-300",children:1===F.user.userStatus?"启用":"禁用"})})]})]})}),(0,s.jsxs)("div",{className:"flex-1 overflow-hidden flex flex-col px-6 py-4 bg-muted/10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-4 shrink-0",children:[(0,s.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,s.jsx)(b.Users,{className:"w-5 h-5 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-base font-semibold",children:"分配角色"}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["已分配 ",F.roles.length," / ",M.length," 个角色"]})]})]}),(0,s.jsx)("div",{className:"flex-1 w-full min-h-0 overflow-y-auto",children:(0,s.jsxs)("div",{className:"bg-card rounded-xl border shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-muted/50 border-b border-border",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:M.length>0&&F.roles.length===M.length,ref:e=>{if(e){let s=M.length>0&&F.roles.length===M.length;e.indeterminate=F.roles.length>0&&F.roles.length<M.length&&!s}},onChange:e=>{e.target.checked?R({...F,roles:M.map(e=>({roleId:e.roleId,roleName:e.roleName,roleCode:e.roleCode}))}):R({...F,roles:[]})},className:"rounded border-gray-300 w-5 h-5 cursor-pointer"}),(0,s.jsx)(c.Label,{className:"font-medium cursor-pointer",children:"全选 / 取消全选"})]}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[F.roles.length," / ",M.length]})]}),(0,s.jsx)("div",{className:"p-4",children:0===M.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[(0,s.jsx)(b.Users,{className:"w-10 h-10 mb-2 opacity-50"}),(0,s.jsx)("p",{className:"text-sm",children:"暂无角色数据"})]}):(0,s.jsx)("div",{className:"grid grid-cols-2 gap-3 ml-8",children:M.map(e=>{let a=F.roles.some(s=>s.roleId===e.roleId);return(0,s.jsxs)("div",{className:`flex items-center gap-3 py-2 px-3 rounded-lg transition-colors cursor-pointer ${a?"bg-primary/10 border border-primary/20":"hover:bg-muted/50"}`,onClick:()=>{a?R({...F,roles:F.roles.filter(s=>s.roleId!==e.roleId)}):R({...F,roles:[...F.roles,{roleId:e.roleId,roleName:e.roleName,roleCode:e.roleCode}]})},children:[(0,s.jsx)("input",{type:"checkbox",checked:a,onChange:()=>{},className:"rounded border-gray-300 w-4 h-4 cursor-pointer"}),(0,s.jsx)(c.Label,{className:"cursor-pointer flex items-center gap-2 min-w-0 flex-1",children:(0,s.jsx)("span",{className:"font-medium truncate",children:e.roleName})})]},e.roleId)})})})]})})]})]}),(0,s.jsxs)(o.DialogFooter,{className:"px-6 py-4 border-t border-border bg-muted/30 shrink-0",children:[(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>L(!1),className:"h-10 px-6",disabled:ea,children:"取消"}),(0,s.jsx)(n.Button,{onClick:eh,className:"h-10 px-6",disabled:ea,children:ea?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"保存中..."]}):"保存更改"})]})]})})]})}e.s(["default",()=>V],17058)}]);