(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52078,e=>{"use strict";var a=e.i(43476),s=e.i(71645),l=e.i(13293),t=e.i(67881),r=e.i(23750),n=e.i(94179),d=e.i(70065),i=e.i(30374),c=e.i(10708),o=e.i(84762),m=e.i(27341),h=e.i(71435),x=e.i(47627),u=e.i(58041),b=e.i(75254);let p=(0,b.default)("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);var j=e.i(55436),N=e.i(7233),g=e.i(86536),f=e.i(27612);let v=(0,b.default)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),T=(0,b.default)("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);var y=e.i(43531),w=e.i(46696),C=e.i(38036),D=e.i(38447),L=e.i(20783),E=e.i(30030),S=e.i(81140),I=e.i(69340),A=e.i(99682),k=e.i(35804),$=e.i(96626),O=e.i(48425),R="Checkbox",[M,B]=(0,E.createContextScope)(R),[H,P]=M(R),U=s.forwardRef((e,l)=>{let{__scopeCheckbox:t,name:r,checked:n,defaultChecked:d,required:i,disabled:c,value:o="on",onCheckedChange:m,form:h,...x}=e,[u,b]=s.useState(null),p=(0,L.useComposedRefs)(l,e=>b(e)),j=s.useRef(!1),N=!u||h||!!u.closest("form"),[g=!1,f]=(0,I.useControllableState)({prop:n,defaultProp:d,onChange:m}),v=s.useRef(g);return s.useEffect(()=>{let e=u?.form;if(e){let a=()=>f(v.current);return e.addEventListener("reset",a),()=>e.removeEventListener("reset",a)}},[u,f]),(0,a.jsxs)(H,{scope:t,state:g,disabled:c,children:[(0,a.jsx)(O.Primitive.button,{type:"button",role:"checkbox","aria-checked":X(g)?"mixed":g,"aria-required":i,"data-state":q(g),"data-disabled":c?"":void 0,disabled:c,value:o,...x,ref:p,onKeyDown:(0,S.composeEventHandlers)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,S.composeEventHandlers)(e.onClick,e=>{f(e=>!!X(e)||!e),N&&(j.current=e.isPropagationStopped(),j.current||e.stopPropagation())})}),N&&(0,a.jsx)(_,{control:u,bubbles:!j.current,name:r,value:o,checked:g,required:i,disabled:c,form:h,style:{transform:"translateX(-100%)"},defaultChecked:!X(d)&&d})]})});U.displayName=R;var V="CheckboxIndicator",F=s.forwardRef((e,s)=>{let{__scopeCheckbox:l,forceMount:t,...r}=e,n=P(V,l);return(0,a.jsx)($.Presence,{present:t||X(n.state)||!0===n.state,children:(0,a.jsx)(O.Primitive.span,{"data-state":q(n.state),"data-disabled":n.disabled?"":void 0,...r,ref:s,style:{pointerEvents:"none",...e.style}})})});F.displayName=V;var _=e=>{let{control:l,checked:t,bubbles:r=!0,defaultChecked:n,...d}=e,i=s.useRef(null),c=(0,A.usePrevious)(t),o=(0,k.useSize)(l);s.useEffect(()=>{let e=i.current,a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(c!==t&&a){let s=new Event("click",{bubbles:r});e.indeterminate=X(t),a.call(e,!X(t)&&t),e.dispatchEvent(s)}},[c,t,r]);let m=s.useRef(!X(t)&&t);return(0,a.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n??m.current,...d,tabIndex:-1,ref:i,style:{...e.style,...o,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function X(e){return"indeterminate"===e}function q(e){return X(e)?"indeterminate":e?"checked":"unchecked"}var z=e.i(78784),K=e.i(47163);function G({className:e,...s}){return(0,a.jsx)(U,{"data-slot":"checkbox",className:(0,K.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:(0,a.jsx)(F,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,a.jsx)(z.CheckIcon,{className:"size-3.5"})})})}var J=e.i(62870);let W=[{value:"BIGINT",label:"BIGINT (大整数)"},{value:"INT",label:"INT (整数)"},{value:"SMALLINT",label:"SMALLINT (小整数)"},{value:"TINYINT",label:"TINYINT (微整数)"},{value:"DECIMAL",label:"DECIMAL (小数)"},{value:"FLOAT",label:"FLOAT (浮点数)"},{value:"DOUBLE",label:"DOUBLE (双精度)"},{value:"VARCHAR",label:"VARCHAR (变长字符串)"},{value:"CHAR",label:"CHAR (定长字符串)"},{value:"TEXT",label:"TEXT (长文本)"},{value:"MEDIUMTEXT",label:"MEDIUMTEXT (中等文本)"},{value:"LONGTEXT",label:"LONGTEXT (长文本)"},{value:"DATE",label:"DATE (日期)"},{value:"DATETIME",label:"DATETIME (日期时间)"},{value:"TIMESTAMP",label:"TIMESTAMP (时间戳)"},{value:"TIME",label:"TIME (时间)"},{value:"BOOLEAN",label:"BOOLEAN (布尔值)"},{value:"JSON",label:"JSON (JSON数据)"}];function Y(){let{t:e}=(0,D.useLanguage)(),[b,L]=(0,s.useState)([]),[E,S]=(0,s.useState)(!0),[I,A]=(0,s.useState)(""),[k,$]=(0,s.useState)(null),[O,R]=(0,s.useState)([]),[M,B]=(0,s.useState)(""),[H,P]=(0,s.useState)(!1),[U,V]=(0,s.useState)(!1),[F,_]=(0,s.useState)(!1),[X,q]=(0,s.useState)(""),[z,K]=(0,s.useState)(null),[Y,Z]=(0,s.useState)(!1),[Q,ee]=(0,s.useState)(""),[ea,es]=(0,s.useState)(""),[el,et]=(0,s.useState)([]),[er,en]=(0,s.useState)([]),[ed,ei]=(0,s.useState)(""),[ec,eo]=(0,s.useState)(!1),em=async()=>{S(!0);try{let e=await (0,C.fetchWithAuth)("/admin/database/tables"),a=await e.json();200===a.code&&a.data?L(a.data):w.toast.error(a.message||"获取表列表失败")}catch(e){console.error("获取表列表失败",e),w.toast.error("获取表列表失败")}finally{S(!1)}};(0,s.useEffect)(()=>{em()},[]);let eh=b.filter(e=>e.tableName.toLowerCase().includes(I.toLowerCase())||e.remarks&&e.remarks.toLowerCase().includes(I.toLowerCase())),ex=async e=>{$(e),P(!0);try{let[a,s]=await Promise.all([(0,C.fetchWithAuth)(`/admin/database/tables/${e}/schema`),(0,C.fetchWithAuth)(`/admin/database/tables/${e}/ddl`)]),l=await a.json(),t=await s.json();200===l.code&&l.data&&R(l.data),200===t.code&&t.data&&B(t.data)}catch(e){console.error("获取表结构失败",e),w.toast.error("获取表结构失败")}},eu=async()=>{if(!X.trim())return void w.toast.error("请输入DDL语句");try{let e=await (0,C.fetchWithAuth)("/admin/database/ddl/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ddl:X})}),a=await e.json();200===a.code&&a.data?(K(a.data),w.toast.success("DDL语法验证通过")):w.toast.error(a.message||"DDL语法验证失败")}catch(e){console.error("DDL预览失败",e),w.toast.error("DDL预览失败")}},eb=async()=>{if(!X.trim())return void w.toast.error("请输入DDL语句");Z(!0),K(null);try{let e=await (0,C.fetchWithAuth)("/admin/database/ddl",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ddl:X})}),a=await e.json();200===a.code&&a.data?(K(a.data),a.data.success?(w.toast.success(a.data.message),em()):w.toast.error(a.data.errorMessage||"DDL执行失败")):w.toast.error(a.message||"DDL执行失败")}catch(e){console.error("DDL执行失败",e),w.toast.error("DDL执行失败")}finally{Z(!1)}},ep=(e,a,s)=>{et(el.map(l=>l.id===e?{...l,[a]:s}:l))},ej=()=>{if(!Q.trim()||0===el.length)return{mainDDL:"",indexDDLs:[]};let e=Q.trim(),a=el.map(e=>{let a=`  \`${e.name.trim()}\` ${e.type}`;return e.length&&["VARCHAR","CHAR","DECIMAL","FLOAT","DOUBLE"].includes(e.type)&&(a+=`(${e.length})`),e.primaryKey?(a+=" NOT NULL",e.autoIncrement&&["BIGINT","INT","SMALLINT","TINYINT"].includes(e.type)&&(a+=" AUTO_INCREMENT")):e.nullable||(a+=" NOT NULL"),e.defaultValue&&(a+=` DEFAULT ${e.defaultValue}`),e.comment&&(a+=` COMMENT '${e.comment}'`),a}),s=el.filter(e=>e.primaryKey).map(e=>`\`${e.name.trim()}\``);s.length>0&&a.push(`  PRIMARY KEY (${s.join(", ")})`);let l=`CREATE TABLE \`${e}\` (
${a.join(",\n")}
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;`,t=[];return el.forEach((a,s)=>{if("normal"===a.indexType){let s=`idx_${e}_${a.name.trim()}`,l=`CREATE INDEX \`${s}\` ON \`${e}\` (\`${a.name.trim()}\``;a.indexLength&&(l+=`(${a.indexLength})`),l+=");",t.push(l)}else if("unique"===a.indexType){let s=`uniq_${e}_${a.name.trim()}`,l=`CREATE UNIQUE INDEX \`${s}\` ON \`${e}\` (\`${a.name.trim()}\``;a.indexLength&&(l+=`(${a.indexLength})`),l+=");",t.push(l)}else if("fulltext"===a.indexType){let s=`ft_${e}_${a.name.trim()}`,l=`CREATE FULLTEXT INDEX \`${s}\` ON \`${e}\` (\`${a.name.trim()}\`);`;t.push(l)}}),er.forEach(a=>{let s=a.name.trim()||`comp_${e}_${a.columns.join("_")}`,l="";l=("unique"===a.type?`CREATE UNIQUE INDEX \`${s}\` ON \`${e}\` (`:`CREATE INDEX \`${s}\` ON \`${e}\` (`)+a.columns.map(e=>`\`${e.trim()}\``).join(", ")+");",t.push(l)}),{mainDDL:l,indexDDLs:t}},eN=e=>!!e.trim()&&/^[a-zA-Z][a-zA-Z0-9_]*$/.test(e.trim()),eg=e=>!!e.trim()&&/^[a-zA-Z][a-zA-Z0-9_]*$/.test(e.trim());(0,s.useEffect)(()=>{let e=ej();ei(e.mainDDL+(e.indexDDLs.length>0?"\n\n"+e.indexDDLs.join("\n"):""))},[Q,el,er]);let ef=async()=>{if(!eN(Q))return void w.toast.error("表名必须以字母开头，只能包含字母、数字和下划线");if(0===el.length)return void w.toast.error("请至少添加一个字段");for(let e of el)if(!eg(e.name))return void w.toast.error(`字段名"${e.name}"格式不正确，必须以字母开头，只能包含字母、数字和下划线`);let e=ej();if(!e.mainDDL)return void w.toast.error("DDL生成失败");Z(!0),K(null);try{let a=await (0,C.fetchWithAuth)("/admin/database/ddl",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ddl:e.mainDDL})}),s=await a.json();if(200===s.code&&s.data)if(K(s.data),s.data.success){if(w.toast.success("表创建成功"),e.indexDDLs.length>0){for(let a of e.indexDDLs)try{let e=await (0,C.fetchWithAuth)("/admin/database/ddl",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ddl:a})}),s=await e.json();200===s.code&&s.data?.success||console.error("索引创建失败",s.message||s.data?.errorMessage)}catch(e){console.error("索引创建失败",e)}w.toast.success(`表创建成功，已创建 ${e.indexDDLs.length} 个索引`)}_(!1),ev(),em()}else w.toast.error(s.data.errorMessage||"DDL执行失败");else w.toast.error(s.message||"DDL执行失败")}catch(e){console.error("DDL执行失败",e),w.toast.error("DDL执行失败")}finally{Z(!1)}},ev=()=>{ee(""),et([]),en([]),ei(""),eo(!1)},eT=(e,a,s)=>{en(er.map(l=>l.id===e?{...l,[a]:s}:l))};return(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)(l.Header,{title:e.dashboard.database,description:e.dashboard.databaseDescription}),(0,a.jsx)("div",{className:"p-6 space-y-6 flex-1 overflow-auto",children:(0,a.jsxs)(m.Tabs,{defaultValue:"tables",className:"w-full",children:[(0,a.jsxs)(m.TabsList,{children:[(0,a.jsxs)(m.TabsTrigger,{value:"tables",className:"flex items-center gap-2",children:[(0,a.jsx)(p,{className:"w-4 h-4"}),e.dashboard.tableList]}),(0,a.jsxs)(m.TabsTrigger,{value:"ddl",className:"flex items-center gap-2",children:[(0,a.jsx)(T,{className:"w-4 h-4"}),e.dashboard.ddlEditor]})]}),(0,a.jsx)(m.TabsContent,{value:"tables",className:"mt-4",children:(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{children:[(0,a.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(u.Database,{className:"w-5 h-5"}),e.dashboard.tableList]}),(0,a.jsx)(d.CardDescription,{children:e.dashboard.totalTables.replace("{count}",eh.length.toString())})]}),(0,a.jsxs)(d.CardContent,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,a.jsx)(j.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,a.jsx)(r.Input,{placeholder:e.dashboard.searchTablePlaceholder,value:I,onChange:e=>A(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(t.Button,{onClick:()=>{ev(),_(!0)},className:"gap-2",children:[(0,a.jsx)(N.Plus,{className:"w-4 h-4"}),e.dashboard.createTable]})]}),E?(0,a.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):(0,a.jsx)("div",{className:"border rounded-lg",children:(0,a.jsxs)(x.Table,{children:[(0,a.jsx)(x.TableHeader,{children:(0,a.jsxs)(x.TableRow,{children:[(0,a.jsx)(x.TableHead,{children:e.dashboard.tableName}),(0,a.jsx)(x.TableHead,{children:e.dashboard.remarks}),(0,a.jsx)(x.TableHead,{children:e.dashboard.rowCount}),(0,a.jsx)(x.TableHead,{className:"w-32",children:e.common.actions})]})}),(0,a.jsxs)(x.TableBody,{children:[eh.map(s=>(0,a.jsxs)(x.TableRow,{children:[(0,a.jsx)(x.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p,{className:"w-4 h-4 text-muted-foreground"}),(0,a.jsx)("code",{className:"text-sm",children:s.tableName})]})}),(0,a.jsx)(x.TableCell,{children:s.remarks||"-"}),(0,a.jsx)(x.TableCell,{children:s.rowCount>=0?(0,a.jsx)(n.Badge,{variant:"secondary",children:s.rowCount.toLocaleString()}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,a.jsx)(x.TableCell,{children:(0,a.jsx)("div",{className:"flex items-center gap-1",children:(0,a.jsx)(t.Button,{variant:"ghost",size:"icon",className:"w-8 h-8",onClick:()=>ex(s.tableName),title:e.dashboard.viewSchema,children:(0,a.jsx)(g.Eye,{className:"w-4 h-4"})})})})]},s.tableName)),0===eh.length&&(0,a.jsx)(x.TableRow,{children:(0,a.jsx)(x.TableCell,{colSpan:4,className:"text-center py-8 text-muted-foreground",children:e.dashboard.noTablesFound})})]})]})})]})]})}),(0,a.jsx)(m.TabsContent,{value:"ddl",className:"mt-4",children:(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{children:[(0,a.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(T,{className:"w-5 h-5"}),e.dashboard.ddlEditor]}),(0,a.jsx)(d.CardDescription,{children:e.dashboard.databaseDescription})]}),(0,a.jsx)(d.CardContent,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{children:"DDL"}),(0,a.jsx)(o.Textarea,{value:X,onChange:e=>q(e.target.value),placeholder:"CREATE TABLE...",className:"font-mono h-48"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(t.Button,{variant:"outline",onClick:eu,disabled:!X.trim(),className:"gap-2",children:[(0,a.jsx)(g.Eye,{className:"w-4 h-4"}),e.dashboard.preview]}),(0,a.jsx)(t.Button,{onClick:eb,disabled:!X.trim()||Y,className:"gap-2",children:Y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.dashboard.executing]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v,{className:"w-4 h-4"}),e.dashboard.executeDDL]})})]}),z&&(0,a.jsxs)("div",{className:`p-4 rounded-lg border ${z.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[z.success?(0,a.jsx)(n.Badge,{className:"bg-green-100 text-green-700 border-green-300",children:e.dashboard.executionSuccess}):(0,a.jsx)(n.Badge,{variant:"destructive",children:e.dashboard.executionFailed}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:e.dashboard.timeConsumed.replace("{time}",z.executionTime.toString())})]}),z.success?(0,a.jsx)("p",{className:"text-sm",children:z.message}):(0,a.jsx)("p",{className:"text-sm text-red-600",children:z.errorMessage})]})]})})]})})]})}),(0,a.jsx)(i.Dialog,{open:H,onOpenChange:P,children:(0,a.jsxs)(i.DialogContent,{className:"w-[98vw] sm:max-w-none max-h-[90vh] overflow-hidden flex flex-col p-6",children:[(0,a.jsxs)(i.DialogHeader,{className:"pb-4",children:[(0,a.jsxs)(i.DialogTitle,{className:"flex items-center gap-2 text-xl",children:[(0,a.jsx)(g.Eye,{className:"w-5 h-5"}),e.dashboard.tableSchema.replace("{tableName}",k||"")]}),(0,a.jsx)(i.DialogDescription,{className:"text-base",children:e.dashboard.viewColumnsAndDDL})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden flex flex-col min-h-0",children:(0,a.jsxs)(m.Tabs,{defaultValue:"columns",className:"flex-1 flex flex-col min-h-0",children:[(0,a.jsxs)(m.TabsList,{className:"shrink-0 h-10",children:[(0,a.jsx)(m.TabsTrigger,{value:"columns",className:"px-6",children:e.dashboard.columnInfo}),(0,a.jsx)(m.TabsTrigger,{value:"ddl",className:"px-6",children:"DDL"})]}),(0,a.jsx)(m.TabsContent,{value:"columns",className:"flex-1 overflow-hidden mt-4 min-h-0",children:(0,a.jsx)(h.ScrollArea,{className:"h-[600px] pr-4",children:(0,a.jsx)("div",{className:"border rounded-lg",children:(0,a.jsxs)(x.Table,{children:[(0,a.jsx)(x.TableHeader,{children:(0,a.jsxs)(x.TableRow,{children:[(0,a.jsx)(x.TableHead,{className:"w-16 py-3",children:"#"}),(0,a.jsx)(x.TableHead,{className:"py-3",children:e.dashboard.columnName}),(0,a.jsx)(x.TableHead,{className:"py-3",children:e.dashboard.dataType}),(0,a.jsx)(x.TableHead,{className:"py-3",children:e.dashboard.nullable}),(0,a.jsx)(x.TableHead,{className:"py-3",children:e.dashboard.defaultValue}),(0,a.jsx)(x.TableHead,{className:"py-3",children:e.dashboard.primaryKey})]})}),(0,a.jsx)(x.TableBody,{children:O.map(s=>(0,a.jsxs)(x.TableRow,{className:"hover:bg-muted/50",children:[(0,a.jsx)(x.TableCell,{className:"text-muted-foreground py-3",children:s.ordinalPosition}),(0,a.jsx)(x.TableCell,{className:"py-3",children:(0,a.jsx)("code",{className:"text-sm font-medium",children:s.columnName})}),(0,a.jsx)(x.TableCell,{className:"py-3",children:(0,a.jsxs)("code",{className:"text-sm text-muted-foreground",children:[s.typeName,s.columnSize>0&&`(${s.columnSize})`]})}),(0,a.jsx)(x.TableCell,{className:"py-3",children:(0,a.jsx)(n.Badge,{variant:s.nullable?"secondary":"outline",className:"px-3 py-1",children:s.nullable?e.dashboard.yes:e.dashboard.no})}),(0,a.jsx)(x.TableCell,{className:"py-3",children:(0,a.jsx)("code",{className:"text-sm",children:s.columnDef||"-"})}),(0,a.jsx)(x.TableCell,{className:"py-3",children:s.primaryKey&&(0,a.jsx)(n.Badge,{className:"bg-yellow-100 text-yellow-700 border-yellow-300 px-3 py-1",children:"PK"})})]},s.columnName))})]})})})}),(0,a.jsx)(m.TabsContent,{value:"ddl",className:"flex-1 overflow-hidden mt-4 min-h-0",children:(0,a.jsx)(h.ScrollArea,{className:"h-[600px] pr-4",children:(0,a.jsx)("pre",{className:"p-6 bg-muted rounded-lg text-sm font-mono whitespace-pre-wrap leading-relaxed",children:M||"No Data"})})})]})}),(0,a.jsx)(i.DialogFooter,{className:"pt-4",children:(0,a.jsx)(t.Button,{variant:"outline",onClick:()=>P(!1),className:"px-6",children:e.common.cancel})})]})}),(0,a.jsx)(i.Dialog,{open:F,onOpenChange:_,children:(0,a.jsxs)(i.DialogContent,{className:"w-[98vw] sm:max-w-none max-h-[95vh] h-[95vh] overflow-hidden flex flex-col p-0",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b",children:(0,a.jsxs)(i.DialogHeader,{children:[(0,a.jsxs)(i.DialogTitle,{className:"flex items-center gap-2 text-xl",children:[(0,a.jsx)(N.Plus,{className:"w-5 h-5"}),e.dashboard.createTableTitle]}),(0,a.jsx)(i.DialogDescription,{children:e.dashboard.createTableDesc})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden flex flex-col min-h-0 bg-muted/10",children:(0,a.jsxs)(m.Tabs,{defaultValue:"design",className:"flex-1 flex flex-col min-h-0",children:[(0,a.jsx)("div",{className:"px-6 border-b bg-background",children:(0,a.jsxs)(m.TabsList,{className:"h-12 w-full justify-start rounded-none border-b-0 p-0 bg-transparent",children:[(0,a.jsx)(m.TabsTrigger,{value:"design",className:"relative h-12 rounded-none border-b-2 border-transparent px-4 pb-3 pt-2 font-medium text-muted-foreground data-[state=active]:border-primary data-[state=active]:text-foreground bg-transparent shadow-none",children:e.dashboard.tableDesign}),(0,a.jsxs)(m.TabsTrigger,{value:"indexes",className:"relative h-12 rounded-none border-b-2 border-transparent px-4 pb-3 pt-2 font-medium text-muted-foreground data-[state=active]:border-primary data-[state=active]:text-foreground bg-transparent shadow-none",children:[e.dashboard.indexManage,er.length>0&&(0,a.jsx)(n.Badge,{variant:"secondary",className:"ml-2 h-5 px-1.5 min-w-5",children:er.length})]}),(0,a.jsx)(m.TabsTrigger,{value:"preview",className:"relative h-12 rounded-none border-b-2 border-transparent px-4 pb-3 pt-2 font-medium text-muted-foreground data-[state=active]:border-primary data-[state=active]:text-foreground bg-transparent shadow-none",children:e.dashboard.sqlPreview})]})}),(0,a.jsx)(m.TabsContent,{value:"design",className:"flex-1 overflow-hidden m-0 p-6 data-[state=inactive]:hidden",children:(0,a.jsxs)("div",{className:"flex flex-col h-full gap-6",children:[(0,a.jsxs)("div",{className:"flex items-end gap-4 p-4 border rounded-lg bg-background shadow-sm",children:[(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsxs)(c.Label,{htmlFor:"tableName",className:"text-sm font-medium",children:[e.dashboard.tableName," ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(r.Input,{id:"tableName",value:Q,onChange:e=>ee(e.target.value),placeholder:"e.g. sys_user_log",className:eN(Q)?"border-green-500":""})]}),(0,a.jsx)("div",{className:"flex-1 pb-2",children:(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Only letters, numbers and underscores allowed, must start with a letter"})}),(0,a.jsxs)(t.Button,{onClick:()=>{et([...el,{id:Date.now().toString(),name:"",type:"VARCHAR",length:"255",nullable:!0,primaryKey:!1,autoIncrement:!1,unique:!1,defaultValue:"",comment:"",indexType:"none",indexLength:""}])},className:"gap-2",children:[(0,a.jsx)(N.Plus,{className:"w-4 h-4"}),e.dashboard.addField]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-hidden border rounded-lg bg-background shadow-sm flex flex-col",children:[(0,a.jsxs)("div",{className:"p-3 border-b bg-muted/40 flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"font-medium text-sm flex items-center gap-2",children:[(0,a.jsx)(p,{className:"w-4 h-4"}),e.dashboard.fieldList.replace("{count}",el.length.toString())]}),0===el.length&&(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.dashboard.addField})]}),(0,a.jsx)(h.ScrollArea,{className:"flex-1",children:(0,a.jsx)("div",{className:"p-4 space-y-3",children:0===el.length?(0,a.jsxs)("div",{className:"text-center py-16 text-muted-foreground",children:[(0,a.jsx)(p,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),(0,a.jsx)("p",{children:"No fields, click button above to add"})]}):el.map((s,l)=>(0,a.jsxs)("div",{className:"group relative border rounded-md p-4 hover:border-primary/50 transition-colors bg-card shadow-sm",children:[(0,a.jsx)("div",{className:"absolute right-2 top-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(t.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>{var e;return e=s.id,void et(el.filter(a=>a.id!==e))},children:(0,a.jsx)(f.Trash2,{className:"w-4 h-4"})})}),(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"col-span-3 space-y-1.5",children:[(0,a.jsx)(c.Label,{className:"text-xs text-muted-foreground",children:e.dashboard.columnName}),(0,a.jsx)(r.Input,{value:s.name,onChange:e=>ep(s.id,"name",e.target.value),placeholder:"name",className:`h-9 ${s.name&&eg(s.name)?"border-green-500/50":""}`})]}),(0,a.jsxs)("div",{className:"col-span-3 space-y-1.5",children:[(0,a.jsx)(c.Label,{className:"text-xs text-muted-foreground",children:e.dashboard.dataType}),(0,a.jsxs)(J.Select,{value:s.type,onValueChange:e=>ep(s.id,"type",e),children:[(0,a.jsx)(J.SelectTrigger,{className:"h-9",children:(0,a.jsx)(J.SelectValue,{})}),(0,a.jsx)(J.SelectContent,{children:W.map(e=>(0,a.jsx)(J.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsxs)("div",{className:"col-span-2 space-y-1.5",children:[(0,a.jsx)(c.Label,{className:"text-xs text-muted-foreground",children:"Length/Value"}),(0,a.jsx)(r.Input,{value:s.length,onChange:e=>ep(s.id,"length",e.target.value),placeholder:"255",className:"h-9",disabled:!["VARCHAR","CHAR","DECIMAL","FLOAT","DOUBLE"].includes(s.type)})]}),(0,a.jsxs)("div",{className:"col-span-2 space-y-1.5",children:[(0,a.jsx)(c.Label,{className:"text-xs text-muted-foreground",children:e.dashboard.defaultValue}),(0,a.jsx)(r.Input,{value:s.defaultValue,onChange:e=>ep(s.id,"defaultValue",e.target.value),placeholder:"NULL",className:"h-9"})]}),(0,a.jsxs)("div",{className:"col-span-2 space-y-1.5",children:[(0,a.jsx)(c.Label,{className:"text-xs text-muted-foreground",children:e.dashboard.remarks}),(0,a.jsx)(r.Input,{value:s.comment,onChange:e=>ep(s.id,"comment",e.target.value),placeholder:"comment",className:"h-9"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-dashed",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(G,{id:`pk-${s.id}`,checked:s.primaryKey,onCheckedChange:e=>ep(s.id,"primaryKey",e)}),(0,a.jsx)(c.Label,{htmlFor:`pk-${s.id}`,className:"text-sm cursor-pointer font-normal",children:e.dashboard.primaryKey})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(G,{id:`notnull-${s.id}`,checked:!s.nullable,onCheckedChange:e=>ep(s.id,"nullable",!e)}),(0,a.jsx)(c.Label,{htmlFor:`notnull-${s.id}`,className:"text-sm cursor-pointer font-normal",children:"Not Null"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(G,{id:`unique-${s.id}`,checked:s.unique,onCheckedChange:e=>ep(s.id,"unique",e)}),(0,a.jsx)(c.Label,{htmlFor:`unique-${s.id}`,className:"text-sm cursor-pointer font-normal",children:"Unique"})]}),["BIGINT","INT","SMALLINT","TINYINT"].includes(s.type)&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(G,{id:`autoinc-${s.id}`,checked:s.autoIncrement,onCheckedChange:e=>ep(s.id,"autoIncrement",e)}),(0,a.jsx)(c.Label,{htmlFor:`autoinc-${s.id}`,className:"text-sm cursor-pointer font-normal",children:"Auto Inc"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Index:"}),(0,a.jsxs)(J.Select,{value:s.indexType,onValueChange:e=>ep(s.id,"indexType",e),children:[(0,a.jsx)(J.SelectTrigger,{className:"h-8 w-28 text-xs",children:(0,a.jsx)(J.SelectValue,{})}),(0,a.jsxs)(J.SelectContent,{children:[(0,a.jsx)(J.SelectItem,{value:"none",children:"None"}),(0,a.jsx)(J.SelectItem,{value:"normal",children:"Normal"}),(0,a.jsx)(J.SelectItem,{value:"unique",children:"Unique"}),["VARCHAR","CHAR","TEXT","MEDIUMTEXT","LONGTEXT"].includes(s.type)&&(0,a.jsx)(J.SelectItem,{value:"fulltext",children:"Full Text"})]})]})]})]})]},s.id))})})]})]})}),(0,a.jsx)(m.TabsContent,{value:"indexes",className:"flex-1 overflow-hidden m-0 p-6 data-[state=inactive]:hidden",children:(0,a.jsxs)("div",{className:"flex flex-col h-full gap-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-background shadow-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium",children:"Composite Index Management"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Create indexes with multiple columns"})]}),(0,a.jsxs)(t.Button,{onClick:()=>{en([...er,{id:Date.now().toString(),name:"",columns:[],type:"normal",comment:""}])},className:"gap-2",children:[(0,a.jsx)(N.Plus,{className:"w-4 h-4"}),e.dashboard.addIndex]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden border rounded-lg bg-background shadow-sm",children:(0,a.jsx)(h.ScrollArea,{className:"h-full",children:(0,a.jsx)("div",{className:"p-4 space-y-4",children:0===er.length?(0,a.jsxs)("div",{className:"text-center py-16 text-muted-foreground",children:[(0,a.jsx)(u.Database,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),(0,a.jsx)("p",{children:"No composite indexes"})]}):er.map(e=>(0,a.jsxs)("div",{className:"border rounded-md p-4 bg-card",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"w-64 space-y-1.5",children:[(0,a.jsx)(c.Label,{className:"text-xs text-muted-foreground",children:"Index Name"}),(0,a.jsx)(r.Input,{value:e.name,onChange:a=>eT(e.id,"name",a.target.value),placeholder:"idx_name_status",className:"h-9"})]}),(0,a.jsxs)("div",{className:"w-40 space-y-1.5",children:[(0,a.jsx)(c.Label,{className:"text-xs text-muted-foreground",children:"Type"}),(0,a.jsxs)(J.Select,{value:e.type,onValueChange:a=>eT(e.id,"type",a),children:[(0,a.jsx)(J.SelectTrigger,{className:"h-9",children:(0,a.jsx)(J.SelectValue,{})}),(0,a.jsxs)(J.SelectContent,{children:[(0,a.jsx)(J.SelectItem,{value:"normal",children:"Normal"}),(0,a.jsx)(J.SelectItem,{value:"unique",children:"Unique"})]})]})]}),(0,a.jsx)("div",{className:"flex-1 flex justify-end pt-6",children:(0,a.jsxs)(t.Button,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>{var a;return a=e.id,void en(er.filter(e=>e.id!==a))},children:[(0,a.jsx)(f.Trash2,{className:"w-4 h-4 mr-2"}),"Delete"]})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{className:"text-xs text-muted-foreground",children:"Select Columns (Click to select)"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 p-3 bg-muted/30 rounded-md border border-dashed",children:[el.map(s=>(0,a.jsxs)(t.Button,{variant:e.columns.includes(s.name)?"default":"outline",size:"sm",onClick:()=>{var a,l;return a=e.id,l=s.name,void en(er.map(e=>{if(e.id===a){let a=e.columns.includes(l)?e.columns.filter(e=>e!==l):[...e.columns,l];return{...e,columns:a}}return e}))},className:`h-7 text-xs ${!s.name&&"opacity-50 pointer-events-none"}`,disabled:!s.name,children:[s.name||"Unnamed",e.columns.includes(s.name)&&(0,a.jsx)(y.Check,{className:"w-3 h-3 ml-1"})]},s.id)),0===el.length&&(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:'Add fields in "Design" tab first'})]})]})]},e.id))})})})]})}),(0,a.jsx)(m.TabsContent,{value:"preview",className:"flex-1 overflow-hidden m-0 p-6 data-[state=inactive]:hidden",children:(0,a.jsxs)("div",{className:"h-full flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"font-medium flex items-center gap-2",children:[(0,a.jsx)(T,{className:"w-4 h-4"}),"Generated DDL"]}),(0,a.jsx)(n.Badge,{variant:"outline",children:"Preview Mode"})]}),(0,a.jsx)("div",{className:"flex-1 border rounded-lg bg-slate-950 p-4 overflow-hidden relative group",children:(0,a.jsx)(h.ScrollArea,{className:"h-full",children:(0,a.jsx)("pre",{className:"text-sm font-mono text-slate-50 whitespace-pre-wrap leading-relaxed",children:ed||"-- Please complete table design first"})})})]})})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t bg-background flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:Q?`Creating table: ${Q}`:"Table name not set"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(t.Button,{variant:"outline",onClick:()=>_(!1),disabled:Y,children:e.common.cancel}),(0,a.jsx)(t.Button,{onClick:ef,disabled:!eN(Q)||0===el.length||Y,className:"gap-2",children:Y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Check,{className:"w-4 h-4"}),"Create Now"]})})]})]})]})})]})}function Z(){return(0,a.jsx)(Y,{})}e.s(["default",()=>Z],52078)}]);